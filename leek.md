<!---    |         |         |         |         |         |         |      --->

# Leek

`Leek` is a concept unsubstanticiated, in the same realm and concept as Onion or 
Garlic Routing mixed with concepts from Block Chain and Cryptocurrency idioms.
At a high-level, `Leek` combines fragmentation, packet hashing, multi-path,
forward error correction, distribution of labor, and a pay to play model to 
create an on-demand, resilient, and demand driven peer-to-peer network
cooperatively.

The network and the protocols leveraged by `Leek` DO NOT intend to provide
End-to-End Encryption. `Leek`'s implementation does, However, RECOMMEND a robust
E2EE implementation sit between `Leek` (the underlay) and whatever application
will ride atop it. When utilized as the underlay for an already robust E2EE
implementation, `Leek` can provide the following with limited guarantee:

 - An incredibly performant transmission path with packet loss and minimal
   overhead.
 
 - A high-degree of anonymnity for transmission of information over a 
   universally untrusted set of participating hosts.
   
 - A ubiquitous and failure-resilient autonomous public overlay network.
   
`Leek` accomplishes this feat through separation of duties, transparency in
operation (function, state, and operational management), and through multipath
transmission of multiparty multiplexed stream-data.

<!---    |         |         |         |         |         |         |      --->

## `Leek` Theory, Assumptions, and Incentives

`Leek` has been modeled after financial currency, and just like the financial
markets, `Leek` is a zero sum game. Any financial instrument has value because
there is a demand for it and there is implicit trust that it's value will be
constant in the short term enough to transact, save, or accumulate. As with all
things economics, incentive drives demand. This concept is core to the
principles that shaped `leek`.

The premise for `Leek` follows these constructs to a tee:

 - `Leek`'s goods are data held at `leek-service` points
 
 - `Leek`'s currency is a peer's peers pool of cryptographic 
   `transmission token`s
 
 - The contract that provides liquidity is the standing expectation that any 
   `leek multiplexer` agrees to to distribute a fragment on behalf of it's 
   peer such that the aforementioned peer provides the same service.
 
 - The guarantee that the `leek` network will self sustain is driven by the
   demand for services available and that participation as a `leek multiplexer`
   generates intresnic value through labor exchange for data.
   
 - `Leek`'s labor pool is a made of any `multiplxer` wishing to request data. 
   Prior to submission of a request to a set of `transit multiplexer`s the 
   `client multiplexer` must poses a set of `transmission token`s authorizing 
   delivery of the request via `leek logistics` (transport network).
 
 - A `multiplexer` earns `transmission tokens` by performing (cryptographic)
   work on behalf of it's `peer multiplexer`s. The `peer multiplexer`s (which
   also happen to be potential `transit multiplexers`s then reward the work by
   returning a `transmit token` generated by a third-party `multiplexer`.
   
The model for `Leek` ASSUMES:

 - Cryptography is and MUST BE relatively expensive as it's expense is REQUIRED
   to limit use of brute force as a mechanism to counter its benefit in privacy.
   
 - `transmission token`s represent a finite intrensic, ubiquitous and
   unilaterally valued instrument leveraged for the exchange of data. This brief
   takes no account for the complexities and unraveling that could ensue should
   like currency in the real world, there was a competing instrument in the same
   network, and without testing, validation, and consus STRICTLY FORBIDS 
   modification or participation with machanisms that seek to undermine this
   REQUIREMENT philosphy.

<!---    |         |         |         |         |         |         |      --->

## Requirements

All design modifications SHOULD hold the following criteria universal:

 - The network MUST be transparent to the data that traverses it.

 - The network MUST be stateless and each participant MUST be able to make all
   decisions based on the contents within the packets traversing the network and
   it's knowledge of it's direct peers ONLY.
   
 - Each participant in the network MUST assume any and all of it's peers are
   and compromised, insecure, and capturing network state and their payloads.
   
 - Each transmission MUST be assumed lost post submission to the network, until
   cryptographically proven otherwise.
   
 - All cryptographic work used to secure a transmission by any participant
   MUST be performed by a non-transmitting participant, except the signing 
   of the transmission.
   
   > Requires that the prior computed cryptographic keys used to encrypt a
   > a transmission are ALWAYS computed on a different participant than the
   > next-hop for the transmission. This separation requirement also means at a
   > bare minimum, 15 participants contribute to the transmission and receipt of
   > a single transmission:
   > 
   >  - the source participant
   >  - the (3) first-hop participants
   >  - the (9) second-hop downstream participants
   >  - the participant contributing cryptography
   >  - the destination participant
      
 - The algorithm generating hashes contributing to path selection MUST be
   cryptographically secure.
   
 - Each participant MUST both as a REQUIREMENT and with EXPLICIT LIMITATION ONLY
   track and advertise heuristic and statistic information identified in the
   MX OSM Specification openly to all peers post establishment of peership, so
   any participant can validate the networks state and it's peer's state both
   passively and by querying it's `peerMX`s.
   
As an aside, the quantity of participants combined with an economics-weighted
statistical distribution of load is what provides `Leek` it's potential as a 
network for anonymous transmission. 

<!---    |         |         |         |         |         |         |      --->

## Forward Declarations

**`multiplexer`** -- any `leek` participant.

**`origin multiplexer`** (`originMX`) -- data originator of transmission

**`transit multiplexer`** (`transitMX`) -- one of many next-hops making up a
logical path to a destination.

**``** (``) -- 

**``** (``) -- 

**`leek service address`** (`lsa`) -- Hash assigned temporal 128-bit destination
address.

**`network split`** (`netsplit`) -- A net-split happens when an outage in the
underlay forces established peerships between `multiplexers` to break causing
pathing to reconverge.

**`leek logistics`** (`llog`) -- the entirety of connected `leek` networks,
comprising of a dynamic arrangement of autonomous two-hop networks.

> `NOTE` there can be temporal moments where multiple `llog`s exist independant
> of each other during net splits.

**`transmission tokens`** (`txToken`) -- a cryptographically signed hash
representing authorization to transmit via `leek logistics`.

<!---    |         |         |         |         |         |         |      --->

## Multiplexer (MX)

A multiplexer (MX) is any participant in the network. All MXs participate
in the following roles:

 - **`MX Exchange`** (`mxExch`)-- Routing Protocol Service advertising hash-path
   reachabililty, heuristics, and MX state.
   
 - **`Service Lookup Responder` (`slr`) ** -- Provides caching recursive service lookup 
   of hash-paths which deliver to a destination `lsa`.
   
 - **`Crypto Proxy`** (`cryptoP`) -- Performs cryptographic work in exchange for 
   `txToken`s. (in similar fashion to a Crypto Miner)
   
 - **`Crypto Broker`** (`cryptoB`) -- Validates and disposes of consumed tokens.
   
 - **`Forward Corrected Fragment Path Buffer`** (`FCFPB`) -- Forwarding engine
   

<!---    |         |         |         |         |         |         |      --->

## Transmission Tokens (txToken)

txtokens like currency in financial markets enable use of resources through
exchange. An MX performs cryptographic work on behalf of it's peers, for which
it txTokens. txTokens permit the MX the ability to transmit through the origin
MX or any of the origin MX's peers.

a txToken is bound to a private key or HSM on the `originMX`.

A `txToken` is comprised of:
  - `pub`  - public key for originator
  - `sig1` - signed cert authorized by proxyP.1
  - `sig2` - signed cert authorized by proxyP.2
  - `pathHash` - of `transitMX` in `transitPeer`s `transaction diameter`
  
A `txToken` 

- A `txToken` is created by combining half of each element of work provided by
  two `crypto proxy` peer `MX`s in a network for a given `transitMX`.
  
  
  its purpose is to signed by
  the private key of a `peerMX`'s `cryptoProxy` service.
  
- To minimize birth, death, and transaction time, `leek` defines the concept of
  `transactional diameter`. `Transactional diameter` (`txDiameter`) is the 
  distance from a `transitMX` with which a `txToken` can be birthed, destroyed,
  or exchanged for transmission. Initially this distance will be a single-hop
  from the `transitMX`.
  
  This means the `txDiameter` differs for a given `MX` based on the role for
  that given `MX`. For the `transitMX` role, 
  
- Each `transitMX`s `cryptoB` process tracks various statistics related to
  the pool of `txTokens` in thier transactional diameter. of the
  `txTokens` thier float no less than of 
 `txTokens`.


- `txToken`s are purposefully limited in supply by tying thier birth rate to
  their death rate. Each `transitMX` locally tracks thier peers `txToken` count,
  consumption rate, and generation rate. As the consumption rate of it's peers
  decreases, the transitMX
  
  `Leek` leverages the same model the US FED uses to manage the interest rate
  to manage inflation and interest rates.
  
  
  
  The result is as an oversupply of `txTokens` creates artificial demand sends demand surging
  a mathematical model  therfore demand naturally
  increases supply as the network's load and degree increeses to balance the load. This also means, lack of demand
  decreases supply (invalidating tokens).

- A `txToken` value MUST BE constant. One (1) `txToken` permits one (1) 
  transmission to one (1) `peerMX`.
  
- A mathematical model based on the cryptographically validated consumption
  rate of txtokens creates more or less txTokens at txToken destruction.
  
When a multiplexer attaches to the newtork they must perform cryptographic work
on behalf of other multiplexers. This expended work earns txTokens, which
permits transmission.

<!---    |         |         |         |         |         |         |      --->

## Mechanics

 - All parties transmitting on the network MUST also multiplexers (MX)
 
 - The minimum hash-path is three (3) MX peers wide. Two are required as
   transmit the two halves of the muxed paylaod and third for the Forward Error
   Correction payload. 
   
 - As the degree of each MX expands, an MX can choose to increase it's FEC 
   distribution width to accomodate more paths. The benfit 
 
 - Each party must recieve 4 


## Leek Services

 


## Packet Transmision

1. MX receives a packet
2. MX performs a lookup in it's forwarding-table for the hashed virtual
   interface (HVIF) for the destination leek-service, which returns:
   
     next-hop of destination. 
3. 
